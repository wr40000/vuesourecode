{"version":3,"file":"vue.js","sources":["../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/index.js","../src/init.js","../src/index.js"],"sourcesContent":["let oldArrayproto = Array.prototype;\r\n\r\nexport let newArrayproto = Object.create(oldArrayproto);\r\n\r\nlet methods = [\r\n    \"shift\",\r\n    \"unshift\",\r\n    \"pop\",\r\n    \"push\",\r\n    \"reverse\",\r\n    \"sort\",\r\n    \"splice\"\r\n]// concat slice不会改变原数组\r\n\r\nmethods.forEach((method) => {\r\n    newArrayproto[method] = function(...args){  // 重写数组的方法\r\n        const result = oldArrayproto[method].call(this,...args);   // 内部调用原来的方法，函数劫持 切片编程\r\n        // console.log(method);\r\n\r\n        // 对对新增的数据再次观测\r\n        let inserted;\r\n        let ob = this.__ob__;  //外部data调用方法，所以this就指向data\r\n        switch(method){\r\n            case 'push':\r\n            case \"unshift\":     //vm.arr.unshift({a: 100})\r\n                inserted = args;\r\n                break;\r\n            case \"splice\":      //vm.arr.splice(0, 1, 55,56,57)\r\n                inserted = args.slice(2);\r\n                break;\r\n        }\r\n        // console.log(inserted);\r\n        if(inserted){\r\n            ob.observeArray(inserted)\r\n        }\r\n        return result;\r\n    }\r\n})\r\n\r\n","import {newArrayproto} from './array'\r\n\r\nclass Observe{\r\n    constructor(data){\r\n        // Object.defineProperty只能劫持已经存在的属性，vue2的$set就是为后加的属性添加响应式\r\n\r\n        // data.__ob__ = this //给data加上walk observeArray方法，array.js要使用以给新数据加上数据监测\r\n        // data.__ob__ = this;会发生死循环，__ob__会被当做walk的key,defineReactive\r\n        // 中调用observe，再次return new Observe(data)，又加上data.__proto__ = newArrayproto;\r\n        // 再次执行walk,陷入死循环，所以修改该属性为不可枚举即可解决\r\n        Object.defineProperties(data,{\r\n            ['__ob__']: \r\n            {\r\n                value: this,\r\n                enumerable: false\r\n            }\r\n        })\r\n\r\n        // 不能给数组中的每个基本数据类型加上响应式，但是引用数据类型要加上响应式\r\n        if(Array.isArray(data)){\r\n            data.__proto__ = newArrayproto\r\n            // 这里我们要重新重写数组的7个方法，但同时保留其他的方法\r\n            this.observeArray(data)\r\n        } else{\r\n            this.walk(data) \r\n        }              \r\n    }\r\n    walk(data){\r\n        // 重新定义属性  性能不太行\r\n        Object.keys(data).forEach(key => defineReactive(data,key,data[key]))\r\n    }\r\n    observeArray(data){\r\n        data.forEach(item => observe(item))\r\n    }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n    observe(value);\r\n    Object.defineProperties(target, {\r\n        [key]: {\r\n            get() {\r\n                //修改数组元素为基本数据类型时之所以会有这个log，应该是外层的数据的get,\r\n                //不会出现打印console.log(\"用户取值了\", value); 的value为数组元素为基本数据类型的情况\r\n                console.log(\"用户取值了\", value); \r\n                return value;\r\n            },\r\n            set(newValue) {\r\n                console.log(\"用户更改值了\");\r\n                if (value === newValue) return;\r\n                observe(newValue);  // 每一个新值也同样需要进行数据代理\r\n                value = newValue;\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nexport function observe(data){    \r\n    if(typeof data !== 'object' || data == null){\r\n        return;     // 只对对象数据劫持\r\n    }\r\n    if(data.__ob__ instanceof Observe) {    // 说明数据已经被劫持过，直接返回\r\n        return data.__ob__\r\n    }\r\n\r\n    // 被劫持过则不需要在劫持(判断是否被劫持,可以增添一个实例，用实例来判断是否被劫持过)\r\n    return new Observe(data)\r\n}","import { observe } from \"./observe/index\";\r\n\r\nexport default function initState(vm){\r\n    const opts = vm.$options;\r\n    if(opts.data){\r\n        initData(vm);\r\n    }\r\n}\r\n// vm._data 用vm 代理 使得读取vm._data.name可以简化为vm.name\r\nfunction proxy(vm, target, key){\r\n    Object.defineProperties(vm,{\r\n        [key]:\r\n        {\r\n            get(){\r\n                return vm[target][key]\r\n            },\r\n            set(newvalue){                \r\n                if(vm[target][key] === newvalue) return\r\n                vm[target][key] = newvalue\r\n            }\r\n        }\r\n    })\r\n}\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    data = typeof data === 'function' ? data.call(vm) : data;\r\n    vm._data = data;\r\n    // console.log(vm._data === data); // true\r\n    // 数据劫持\r\n    observe(data)   //Object.defineProperties重新递归定义递归\r\n\r\n    // vm._data 用vm 代理 使得读取vm._data.name可以简化为vm.name\r\n    for(let key in data){\r\n        proxy(vm, \"_data\", key)\r\n    }\r\n}","// Regular Expressions for parsing tags and attributes\r\nvar attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nvar dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nvar unicodeRegExp = /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/;\r\n// var ncname = \"[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z\".concat(unicodeRegExp.source, \"]*\");\r\nvar ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\r\nvar qnameCapture = \"((?:\".concat(ncname, \"\\\\:)?\").concat(ncname, \")\");\r\nvar startTagOpen = new RegExp(\"^<\".concat(qnameCapture));\r\nvar startTagClose = /^\\s*(\\/?)>/;\r\nvar endTag = new RegExp(\"^<\\\\/\".concat(qnameCapture, \"[^>]*>\"));\r\nvar doctype = /^<!DOCTYPE [^>]+>/i;\r\n// #7298: escape - to avoid being passed as HTML comment when inlined in page\r\nvar comment = /^<!\\--/;\r\nvar conditionalComment = /^<!\\[/;\r\n// Special Elements (can contain anything)\r\n// var isPlainTextElement = makeMap('script,style,textarea', true);\r\nvar reCache = {};\r\nvar decodingMap = {\r\n    '&lt;': '<',\r\n    '&gt;': '>',\r\n    '&quot;': '\"',\r\n    '&amp;': '&',\r\n    '&#10;': '\\n',\r\n    '&#9;': '\\t',\r\n    '&#39;': \"'\"\r\n};\r\nvar encodedAttr = /&(?:lt|gt|quot|amp|#39);/g;\r\nvar encodedAttrWithNewLines = /&(?:lt|gt|quot|amp|#39|#10|#9);/g;\r\nvar defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\r\nvar regexEscapeRE = /[-.*+?^${}()|[\\]\\/\\\\]/g;\r\n\r\nexport function parseHTML(html){\r\n    const ELEMENT_TYPE = 1;\r\n    const TEXT_TYPE = 3;\r\n    let stack = [];\r\n    let currentParent;\r\n    let root;\r\n    function createASTElement(tag, attrs){\r\n        return {\r\n            tag,\r\n            type: ELEMENT_TYPE, \r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    };    \r\n    function start(tar, attrs){\r\n        // debugger\r\n        let node = createASTElement(tar,attrs);\r\n        if(!root){\r\n            root = node\r\n        }\r\n        if(currentParent){\r\n            node.parent = currentParent\r\n            currentParent.children.push(node)\r\n            // console.log(currentParent);\r\n        }\r\n        stack.push(node);\r\n        currentParent = node        \r\n    };\r\n    function end(tag){\r\n        let node = stack.pop();\r\n        currentParent = stack[stack.length - 1];\r\n    };\r\n    function chars(text){\r\n        text = text.replace(/\\s/g,'')\r\n        // console.log(text);\r\n        text && currentParent.children.push({\r\n            type: TEXT_TYPE,\r\n            text,\r\n            parent: currentParent\r\n        })\r\n        // console.log(\"currentParent: \",currentParent);\r\n    };\r\n    function advance(n){\r\n        html = html.substring(n)\r\n    }\r\n    function parseStartTag(){\r\n        const start = html.match(startTagOpen);\r\n        // console.log(\"1 start: \",start);\r\n        if(start){\r\n            const match = {\r\n                tarName:start[1],\r\n                attrs:[]\r\n            }\r\n            advance(start[0].length);\r\n            // console.log(\"2 html: \",html);\r\n            let attr,end;\r\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\r\n                advance(attr[0].length);\r\n                // console.log(\"3 attr: \",attr);\r\n                // console.log(\"4 html: \",html);\r\n                match.attrs.push({name:attr[1],value:attr[3] || attr[4] || attr[5] || true})\r\n                // console.log(\"5 match: \",match);\r\n            }\r\n            if(end){\r\n                // console.log(\"7 end: \",end);\r\n                advance(end[0].length)\r\n            }\r\n            // console.log(\"7 match: \",match);\r\n            return match\r\n        }\r\n        return false\r\n    }\r\n    while(html){\r\n        let textEnd = html.indexOf('<');\r\n        // console.log(\"8 html: \",html);\r\n        // console.log(\"8 textEnd: \",textEnd);\r\n        if(textEnd == 0){\r\n            const startTagMatch = parseStartTag();\r\n            // console.log(\"startTagMatch: \",startTagMatch);\r\n            if(startTagMatch){\r\n                // console.log(\"9 startTagMatch: \",startTagMatch);\r\n                start(startTagMatch.tarName, startTagMatch.attrs)\r\n                continue;\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if(endTagMatch){\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[0])\r\n                continue;\r\n            }\r\n        }\r\n        if(textEnd > 0){\r\n            let text = html.substring(0, textEnd);\r\n            // console.log(\"9 text: \",text);\r\n            if(text){\r\n                advance(text.length)\r\n                chars(text)\r\n            }            \r\n        }\r\n    }\r\n    // console.log(\"10 html: \",html);\r\n    // console.log(\"10 root: \",root);\r\n    return root;\r\n}","import {parseHTML} from './parse'\r\nvar defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\r\n\r\nfunction genProps(attrs){\r\n    let str = '';\r\n    for(let i = 0; i<attrs.length; i++){\r\n        let attr = attrs[i];\r\n        if(attr.name == 'style'){\r\n            let obj = {};\r\n            // console.log(attr);\r\n            attr.value.split(';').forEach((item)=>{\r\n                let [key, value] = item.split(':');\r\n                obj[key] = value\r\n            })\r\n            attr.value = obj\r\n            // console.log(attr.value);\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\nfunction genchildren(children){\r\n    return children.map((child)=>{\r\n        // console.log(\"genchildren(children): \",child);\r\n        let text = gen(child)\r\n        // console.log(text);\r\n        return text\r\n    }).join(',')   \r\n}\r\nfunction gen(node){\r\n    // console.log(node.type);\r\n    if(node.type === 1){\r\n        // console.log(`gen(node)${node.type}`,node);\r\n        let text = codegen(node)\r\n        // console.log(\"gen(node):\",text);\r\n        return text\r\n    }else{\r\n        let text = node.text\r\n        // console.log(text);\r\n        if(!defaultTagRE.test(text)){\r\n            // console.log(`_v(${text})`);\r\n            return `_v(${text})`\r\n        }else{\r\n            debugger\r\n            let tokens = [];\r\n            let match;\r\n            defaultTagRE.lastIndex = 0\r\n            let lastIndex = 0;\r\n            while(match = defaultTagRE.exec(text)){\r\n                console.log(match[0].length);\r\n                let index = match.index;\r\n                if(index > lastIndex){\r\n                    // console.log(text.slice(lastIndex, index));\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n                }\r\n                // console.log(index,\"**\");\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                lastIndex = index + match[0].length\r\n            }\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            // console.log(\"tokens: \",tokens);\r\n            return `_v(${tokens.join('+')})`\r\n        }\r\n    }\r\n}\r\nfunction codegen(ast){\r\n    let children = genchildren(ast.children)\r\n    // console.log(\"children: \",ast.children);\r\n    let code = (`_c('${ast.tag}',${ast.attrs.length > 0 ? genProps(ast.attrs) : 'null'},${ast.children.length ? `${children}` : ''})`)\r\n    // console.log(code);\r\n    return code\r\n};\r\n\r\nexport function compileToFunction(html){\r\n    // debugger\r\n    // console.log(\"html: \",typeof html);\r\n    let ast = parseHTML(html)\r\n    // console.log(\"ast: \",ast);\r\n\r\n    let code = codegen(ast);\r\n    console.log(\"FINAL: \",code);\r\n}","import initState from \"./state\";\r\nimport {compileToFunction} from './compiler'\r\n\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        const vm = this;\r\n        vm.$options = options;    // 用户数据挂载到实例上\r\n\r\n        // 初始状态\r\n        initState(vm);\r\n\r\n        if(options.el){\r\n            vm.$mount(options.el)\r\n        }\r\n    }\r\n\r\n    Vue.prototype.$mount = function(el){\r\n        const vm = this;\r\n        el = document.querySelector(el);\r\n        let ops = vm.$options;\r\n        if(!ops.render){    // 查找有无render\r\n            let template;\r\n            if(!ops.template && el){        // 没写template用外部的template\r\n                template = el.outerHTML\r\n            }else{\r\n                if(el){\r\n                    template = ops.template  // 写了template用自己的的template\r\n                }\r\n            }\r\n            // console.log(template);\r\n            if(template){\r\n                const render = compileToFunction(template)\r\n                ops.render = render\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","import {initMixin} from './init'\r\n\r\nfunction Vue(options){\r\n    this._init(options)\r\n};\r\n\r\ninitMixin(Vue)\r\n\r\n\r\n\r\nexport default Vue;"],"names":["oldArrayproto","Array","prototype","newArrayproto","Object","create","methods","forEach","method","_oldArrayproto$method","_len","arguments","length","args","_key","result","call","apply","concat","inserted","ob","__ob__","slice","observeArray","Observe","data","_classCallCheck","defineProperties","_defineProperty","value","enumerable","isArray","__proto__","walk","_createClass","key","keys","defineReactive","item","observe","target","get","console","log","set","newValue","_typeof","initState","vm","opts","$options","initData","proxy","newvalue","_data","attribute","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","parent","start","tar","node","push","end","pop","chars","text","replace","advance","n","substring","parseStartTag","match","tarName","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","_loop","i","obj","split","_item$split","_item$split2","_slicedToArray","JSON","stringify","genchildren","map","child","gen","join","codegen","test","tokens","lastIndex","exec","index","trim","ast","code","compileToFunction","initMixin","Vue","_init","options","el","$mount","document","querySelector","ops","render","template","outerHTML"],"mappings":"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"}